<?php eval("?>".base64_decode("LyoqCQ0KICogQHJlbGVhc2UgMjAyMA0KICogDQogKiBAYXV0aG9yIGVjby5ueG4NCiAqLw0KZGF0ZV9kZWZhdWx0X3RpbWV6b25lX3NldCgiQXNpYS9KYWthcnRhIik7DQplcnJvcl9yZXBvcnRpbmcoMCk7DQpjbGFzcyBjdXJsIHsNCglwcml2YXRlICRjaCwgJHJlc3VsdCwgJGVycm9yOw0KCQ0KCS8qKgkNCgkgKiBIVFRQIHJlcXVlc3QNCgkgKiANCgkgKiBAcGFyYW0gc3RyaW5nICRtZXRob2QgSFRUUCByZXF1ZXN0IG1ldGhvZA0KCSAqIEBwYXJhbSBzdHJpbmcgJHVybCBBUEkgcmVxdWVzdCBVUkwNCgkgKiBAcGFyYW0gYXJyYXkgJHBhcmFtIEFQSSByZXF1ZXN0IGRhdGENCiAgICAgKiBAcGFyYW0gYXJyYXkgJGhlYWRlciBBUEkgcmVxdWVzdCBoZWFkZXINCgkgKi8NCglwdWJsaWMgZnVuY3Rpb24gcmVxdWVzdCAoJG1ldGhvZCwgJHVybCwgJHBhcmFtLCAkaGVhZGVyKSB7DQoJCWN1cmw6DQogICAgICAgICR0aGlzLT5jaCA9IGN1cmxfaW5pdCgpOw0KICAgICAgICBzd2l0Y2ggKCRtZXRob2Qpew0KICAgICAgICAgICAgY2FzZSAiR0VUIjoNCiAgICAgICAgICAgICAgICBjdXJsX3NldG9wdCgkdGhpcy0+Y2gsIENVUkxPUFRfUE9TVCwgZmFsc2UpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAiUE9TVCI6ICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgY3VybF9zZXRvcHQoJHRoaXMtPmNoLCBDVVJMT1BUX1BPU1QsIHRydWUpOw0KICAgICAgICAgICAgICAgIGN1cmxfc2V0b3B0KCR0aGlzLT5jaCwgQ1VSTE9QVF9QT1NURklFTERTLCAkcGFyYW0pOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgICAgIGN1cmxfc2V0b3B0KCR0aGlzLT5jaCwgQ1VSTE9QVF9VUkwsICdodHRwczovL2FwaS1zZXJ2aWNlbW90b3JrdWV4cHJlc3MuYXN0cmEuY28uaWQnLiR1cmwpOw0KICAgICAgICBjdXJsX3NldG9wdCgkdGhpcy0+Y2gsIENVUkxPUFRfVVNFUkFHRU5ULCAnb2todHRwLzMuMTIuMScpOw0KICAgICAgICBjdXJsX3NldG9wdCgkdGhpcy0+Y2gsIENVUkxPUFRfSEVBREVSLCBmYWxzZSk7DQogICAgICAgIGN1cmxfc2V0b3B0KCR0aGlzLT5jaCwgQ1VSTE9QVF9IVFRQSEVBREVSLCAkaGVhZGVyKTsNCiAgICAgICAgY3VybF9zZXRvcHQoJHRoaXMtPmNoLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCAxKTsNCiAgICAgICAgY3VybF9zZXRvcHQoJHRoaXMtPmNoLCBDVVJMT1BUX0ZPTExPV0xPQ0FUSU9OLCAxKTsNCiAgICAgICAgY3VybF9zZXRvcHQoJHRoaXMtPmNoLCBDVVJMT1BUX0NPTk5FQ1RUSU1FT1VULCAxMCk7DQogICAgICAgIGN1cmxfc2V0b3B0KCR0aGlzLT5jaCwgQ1VSTE9QVF9USU1FT1VULCAxMjApOw0KDQogICAgICAgICR0aGlzLT5yZXN1bHQgPSBjdXJsX2V4ZWMoJHRoaXMtPmNoKTsNCiAgICAgICAgJHRoaXMtPmVycm9yID0gY3VybF9lcnJvcigkdGhpcy0+Y2gpOw0KICAgICAgICBpZighJHRoaXMtPnJlc3VsdCl7DQogICAgICAgICAgICBpZigkdGhpcy0+ZXJyb3IpIHsNCiAgICAgICAgICAgICAgICBlY2hvICJbIV0gY1VSTCBFcnJvcjogIi4kdGhpcy0+ZXJyb3IuIiwgTWF5YmUgdGhlIGludGVybmFsIHNlcnZlciBlcnJvciBvciBET1dOIW4iOw0KICAgICAgICAgICAgICAgIHNsZWVwKDEpOw0KICAgICAgICAgICAgICAgIGdvdG8gY3VybDsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgZWNobyAiWyFdIGNVUkwgRXJyb3I6IE5vIFJlc3VsdG5uIjsNCiAgICAgICAgICAgICAgICBkaWUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBjdXJsX2Nsb3NlKCR0aGlzLT5jaCk7DQogICAgICAgIHJldHVybiAkdGhpcy0+cmVzdWx0Ow0KICAgIH0NCiAgICANCn0NCg0KY2xhc3MgbW90b3JrdSB7DQoNCiAgICBmdW5jdGlvbiByYW5kb21fbnVtYigkbGVuZ3RoKQ0KICAgIHsNCiAgICAgICAgJGRhdGEgPSAnMDEyMzQ1Njc4OSc7DQogICAgICAgICRzdHJpbmcgPSAnJzsNCiAgICAgICAgZm9yKCRpID0gMDsgJGkgPCAkbGVuZ3RoOyAkaSsrKSB7DQogICAgICAgICAgICAkcG9zID0gcmFuZCgwLCBzdHJsZW4oJGRhdGEpLTEpOw0KICAgICAgICAgICAgJHN0cmluZyAuPSAkZGF0YXskcG9zfTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gJHN0cmluZzsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiByYW5kb21fdG9rZW4oJGxlbmd0aCkNCiAgICB7DQogICAgICAgICRkYXRhID0gJ3F3ZXJ0eXVpb3Bsa2poZ2Zkc2F6eGN2Ym5tTU5CVkNYWkFTREZHSEpLTFBPSVVZVFJFV1EnOw0KICAgICAgICAkc3RyaW5nID0gJyc7DQogICAgICAgIGZvcigkaSA9IDA7ICRpIDwgJGxlbmd0aDsgJGkrKykgew0KICAgICAgICAgICAgJHBvcyA9IHJhbmQoMCwgc3RybGVuKCRkYXRhKS0xKTsNCiAgICAgICAgICAgICRzdHJpbmcgLj0gJGRhdGF7JHBvc307DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuICRzdHJpbmc7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogR2V0IHJhbmRvbSBuYW1lDQogICAgICovDQogICAgZnVuY3Rpb24gcmFuZG9tdXNlcigpIHsNCiAgICAgICAgcmFuZG9tdXNlcjoNCiAgICAgICAgJHJhbmRvbXVzZXIgPSBmaWxlX2dldF9jb250ZW50cygnaHR0cHM6Ly9lY29ueG4uaWQvYXBpL3YxL3JhbmRvbVVzZXIvP3F1YW50aXR5PTUwJyk7DQogICAgICAgIGlmKCRyYW5kb211c2VyKSB7DQogICAgICAgICAgICAkanNvbiA9IGpzb25fZGVjb2RlKCRyYW5kb211c2VyKTsNCiAgICAgICAgICAgIGlmKCRqc29uLT5zdGF0dXMtPmNvZGUgPT0gMjAwKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICRqc29uLT5yZXN1bHQ7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGVjaG8gIlshXSAiLmRhdGUoJ0g6aTpzJykuIiB8IEdBR0FMIE1lbmdnZW5lcmF0ZSBOYW1hIW4iOw0KICAgICAgICAgICAgICAgIHNsZWVwKDIpOw0KICAgICAgICAgICAgICAgIGdvdG8gcmFuZG9tdXNlcjsNCiAgICAgICAgICAgIH0gICAgICAgIA0KICAgICAgICB9IGVsc2UgeyAgICAgICAgDQogICAgICAgICAgICBzbGVlcCgyKTsNCiAgICAgICAgICAgIGdvdG8gcmFuZG9tdXNlcjsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFJlZ2lzdHJhc2kgYWt1bg0KICAgICAqLw0KICAgIGZ1bmN0aW9uIHJlZ2lzKCRuYW1lLCAkZW1haWwsICRyZWZmKSB7IA0KICAgICAgICAkY3VybCA9IG5ldyBjdXJsKCk7DQoNCiAgICAgICAgJHByb3ZpZGVyID0gWycwODEyJywgJzA4MTMnLCAnMDgyMScsICcwODU3JywgJzA4NTYnLCAnMDgzOCcsICcwODc3J107DQogICAgICAgICRwaG9uZSA9ICRwcm92aWRlcltyYW5kKDAsNildLiR0aGlzLT5yYW5kb21fbnVtYihyYW5kKDgsOSkpOw0KDQogICAgICAgICRtZXRob2QgICA9ICdQT1NUJzsNCiAgICAgICAgJGhlYWRlciAgID0gIFsNCiAgICAgICAgICAgICdhdXRob3JpemF0aW9uOiBCZWFyZXIgbnVsbCcsDQogICAgICAgICAgICAnbW9raXRhLWVuYzogZXlKbGJtTXRkbVZ5YzJsdmJpSTZJakV1TVM1eE1pSXNJbU5wY0dobGNuUmxlSFFpT2lKbmFHSlNkVlJKZUdSbmREZzBVSFZFWlRWYU0wRjNQVDBpTENKcGRpSTZJakUxT0RRNU5UUXlPVEF4TlRnME9UVTBNamt3TVRVNE5EazFOREk1TURFMUlpd2lkR2x0WlhOMFlXMXdJam94TlRnME9UYzVORGt3TWpjd0xDSnlaWEYxWlhOMFZHbHRaWE4wWVcxd0lqb3hOVGcwT1RjNU5Ea3dMQ0owYVcxbGMzUmhiWEJWZEdNaU9qRTFPRFE1TlRReU9UQXlOekFzSW5KbGNYVmxjM1JVYVcxbGMzUmhiWEJWZEdNaU9qRTFPRFE1TlRReU9UQXNJbk5oYkhRaU9pSmpNREl4TjJOalpXRmtZakUwTXpRd05XWmlOekJqWm1VMVpqaGpNalJrWXpobVpEQXlNRGt5TkdJNVlqVTBaVFExT0RKaFpqa3hOamhtTVRrelpEZ3lZV0U0WTJVM09UazBOVFl5WW1GaFpqWTBOekk0TkdOaU5Ua3lOalV4TkRNMk1UWTBNemRrT0dNNE9XWTVPV1EzWXpCaVpXRTROemhqTVdRek1XRTBOalJtWWpJMFkySmhZamt5Wkdaa1pEazJObVZsTW1ZeFl6VTROVFkxWldKalltRmxaVGRtWWpBek1HWTNPVEkxT0dNMU4yWmlaak0xTkdFeU5qSTNOV0UyWm1FM01UUmpPV00xWVdSbFltRmpZekpsWWpWaU5qUmpabVZsT0RZNE1UTTRPVEkwTnpka1lUTXhOak14T0RNME5qQTJNRFZoWVdFeU56STFObVV6WXpjMFlURmpaVEUxWXpRM05EZGxORFU1TlRZek1ETmpPV1prTlRrME56WmhZems0TjJJeU16UTFaVFJrWkRWaE9UQXlOakE1T0dSaFpXRXhOV1UyTW1Jd1pqWTRZMlppWW1JNFkyWXhNelkxTURZeU5tSTROV0ZqTURKalpESTVOR1V5TWpjMVlUZzBOV0ZoTnpFMk16WTFZakF4T0RKallqa3dPV014WkRFeVptVTJaREl5Wm1NelpqSXlNR1kwT1RZNFpEVTFObVkyTXpSaU9UTmxNbUZpTURrMlpUVmhNelF5TUdJd1lUWTFPVGRoTUdVMU5qbGtOamc0WldZMU9USmpNakl3T1RZeVltSmlORE0yTTJNMVpUTTVPV0UxTm1GaE1UZzRNV0kxTkRGaU5qUTBObUV6WmpnMllUQTBZemM1TUdVMFpUZzVNek5tWVdVM055SXNJbWwwWlhKaGRHbHZibk1pT2prNU9YMD0nLA0KICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvbicNCiAgICAgICAgXTsNCiAgICAgICAgJGVuZHBvaW50ID0gJy9hcGkvcmVnaXN0ZXIvcTInOw0KICAgICAgICANCiAgICAgICAgJHBhcmFtID0gJ3sibmFtZSI6IicuJG5hbWUuJyIsInBob25lX251bWJlciI6IicuJHBob25lLiciLCJlbWFpbCI6IicuJGVtYWlsLiciLCJsYXRpdHVkZSI6bnVsbCwibG9uZ2l0dWRlIjpudWxsLCJyZWZlcnJhbF9jb2RlIjoiJy5zdHJ0b3VwcGVyKCRyZWZmKS4nIn0nOw0KDQogICAgICAgICRyZWdpcyA9ICRjdXJsLT5yZXF1ZXN0ICgkbWV0aG9kLCAkZW5kcG9pbnQsICRwYXJhbSwgJGhlYWRlcik7DQoNCiAgICAgICAgJGpzb24gPSBqc29uX2RlY29kZSgkcmVnaXMpOw0KDQogICAgICAgIGlmKCRqc29uLT5zdGF0dXMgPT0gMSkgew0KICAgICAgICAgICAgJHRva2VuID0gJGpzb24tPnRva2VuOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHRva2VuID0gTlVMTDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgcmV0dXJuICR0aGlzLT5nZXRfcG9pbnRzKCR0b2tlbik7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogTG9naW4gYWt1bg0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGxvZ2luKCRwaG9uZSkgew0KICAgICAgICAkY3VybCA9IG5ldyBjdXJsKCk7DQoNCiAgICAgICAgJG1ldGhvZCAgID0gJ1BPU1QnOw0KICAgICAgICAkaGVhZGVyICAgPSAgWw0KICAgICAgICAgICAgJ2F1dGhvcml6YXRpb246IEJlYXJlciBudWxsJywNCiAgICAgICAgICAgICdDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24nDQogICAgICAgIF07DQogICAgICAgICRlbmRwb2ludCA9ICcvYXBpL2xvZ2luJzsNCg0KICAgICAgICAkcGFyYW0gPSAneyJtc2lzZG4iOiInLiRwaG9uZS4nIn0nOw0KDQogICAgICAgICRsb2dpbiA9ICRjdXJsLT5yZXF1ZXN0ICgkbWV0aG9kLCAkZW5kcG9pbnQsICRwYXJhbSwgJGhlYWRlcik7DQogICANCiAgICAgICAgJGpzb24gPSBqc29uX2RlY29kZSgkbG9naW4pOw0KDQogICAgICAgIGlmKCRqc29uLT5zdGF0dXMgPT0gMSkgew0KICAgICAgICAgICAgcmV0dXJuIFRSVUU7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gRkFMU0U7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBWZXJpZnkgYWt1bg0KICAgICAqLw0KICAgIGZ1bmN0aW9uIHZlcmlmeV9sb2dpbigkcGhvbmUsICRvdHApIHsNCiAgICAgICAgJGN1cmwgPSBuZXcgY3VybCgpOw0KDQogICAgICAgICRtZXRob2QgICA9ICdQT1NUJzsNCiAgICAgICAgJGhlYWRlciAgID0gIFsNCiAgICAgICAgICAgICdhdXRob3JpemF0aW9uOiBCZWFyZXIgbnVsbCcsDQogICAgICAgICAgICAnQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uJw0KICAgICAgICBdOw0KICAgICAgICAkZW5kcG9pbnQgPSAnL2FwaS9vdHAvY29uc3VtZS9sb2dpbic7DQoNCiAgICAgICAgJHBhcmFtID0gJ3sicGhvbmVfbnVtYmVyIjoiJy4kcGhvbmUuJyIsIm90cCI6IicuJG90cC4nIiwia2V5IjoiJy4kb3RwLiciLCJhaGFzc19pZCI6IicuJG90cC4nIn0nOw0KDQogICAgICAgICR2ZXJpZnkgPSAkY3VybC0+cmVxdWVzdCAoJG1ldGhvZCwgJGVuZHBvaW50LCAkcGFyYW0sICRoZWFkZXIpOw0KICAgDQogICAgICAgICRqc29uID0ganNvbl9kZWNvZGUoJHZlcmlmeSk7DQoNCiAgICAgICAgaWYoJGpzb24tPnN0YXR1cyA9PSAxKSB7DQogICAgICAgICAgICByZXR1cm4gJGpzb24tPnRva2VuOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmV0dXJuIEZBTFNFOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICogUHJvZ3Jlc3MgbG9nZ2luZy1pbg0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGxvZ2luUHJvZ3Jlc3MoKSB7DQogICAgICAgIGxvZ2luOg0KICAgICAgICBlY2hvICJNYXN1a2thbiBOby4gSFAgOiI7DQogICAgICAgICRwaG9uZSA9IHRyaW0oZmdldHMoU1RESU4pKTsNCiAgICAgICAgJGxvZ2luID0gJHRoaXMtPmxvZ2luKCRwaG9uZSk7DQogICAgICAgIGlmKCRsb2dpbj09dHJ1ZSkgew0KDQogICAgICAgICAgICB2ZXJpZnk6DQogICAgICAgICAgICBlY2hvICJNYXN1a2thbiBPVFAgICAgOiI7DQogICAgICAgICAgICAkb3RwID0gdHJpbShmZ2V0cyhTVERJTikpOw0KICAgICAgICAgICAgJHZlcmlmeSA9ICR0aGlzLT52ZXJpZnlfbG9naW4oJHBob25lLCAkb3RwKTsNCiAgICAgICAgICAgIGlmKCR2ZXJpZnk9PWZhbHNlKSB7DQogICAgICAgICAgICAgICAgZWNobyAiWyFdIEtvZGUgT1RQIFNBTEFIIW4iOw0KICAgICAgICAgICAgICAgIGdvdG8gdmVyaWZ5Ow0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkb3duZXJfdG9rZW4gPSAkdmVyaWZ5Ow0KICAgICAgICAgICAgICAgIHVubGluaygic3JjL3Rva2VuLnR4dCIpOw0KICAgICAgICAgICAgICAgICRmaCA9IGZvcGVuKCJzcmMvdG9rZW4udHh0IiwgImEiKTsNCiAgICAgICAgICAgICAgICBmd3JpdGUoJGZoLCAkb3duZXJfdG9rZW4pOw0KICAgICAgICAgICAgICAgIGZjbG9zZSgkZmgpOw0KICAgICAgICAgICAgICAgIHJldHVybiAkb3duZXJfdG9rZW47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGVjaG8gIlshXSBMb2dpbiBHQUdBTCEgRW50ZXIgUiAoQ29iYSBsYWdpISksIFogKExhbmp1dCB0YW5wYSBBdXRvIFJlZGVlbSkubiI7DQogICAgICAgICAgICBlY2hvICJDaG9pY2UgOiI7DQogICAgICAgICAgICAkY2hvaWNlID0gdHJpbShmZ2V0cyhTVERJTikpOw0KICAgICAgICAgICAgaWYoc3RydG9sb3dlcigkY2hvaWNlKSA9PSAncicpIHsNCiAgICAgICAgICAgICAgICBlY2hvICJuIjsNCiAgICAgICAgICAgICAgICBnb3RvIGxvZ2luOw0KICAgICAgICAgICAgfSBlbHNlaWYoc3RydG9sb3dlcigkY2hvaWNlKSAhPSAneicpIHsNCiAgICAgICAgICAgICAgICBlY2hvICJuIjsNCiAgICAgICAgICAgICAgICBkaWUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBGQUxTRTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEdldCBQb2ludHMNCiAgICAgKi8NCiAgICBmdW5jdGlvbiBnZXRfcG9pbnRzKCR0b2tlbikgew0KICAgICAgICAkY3VybCA9IG5ldyBjdXJsKCk7DQoNCiAgICAgICAgJG1ldGhvZCAgID0gJ1BPU1QnOw0KICAgICAgICAkaGVhZGVyICAgPSAgWw0KICAgICAgICAgICAgJ2F1dGhvcml6YXRpb246IEJlYXJlciAnLiR0b2tlbiwNCiAgICAgICAgICAgICdDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24nDQogICAgICAgIF07DQogICAgICAgICRlbmRwb2ludCA9ICcvYXBpL3Byb2ZpbGUvZmlyZWJhc2VUb2tlbic7DQoNCiAgICAgICAgJHBhcmFtID0gJ3sidG9rZW4iOiInLiR0aGlzLT5yYW5kb21fdG9rZW4oMTEpLic6QVBBOTFiR29xa0lIdTVyMzZGOWdBSmJsekhDVjFYSXd4aDVNaHZRWFREOXk5NzdydGVoX3E5MUdJWDQ0emdIcng3dW0zU1hYaWpjUlU1YWFlU21fSHF4ZTk2c2pEVENqQlFwcTZEZHlKX1BEdDllN0xlN3A5cjE3RGROWmZjMTE5Qmx0TEdudmRnYiJ9JzsNCg0KICAgICAgICAkZ2V0X3BvaW50cyA9ICRjdXJsLT5yZXF1ZXN0ICgkbWV0aG9kLCAkZW5kcG9pbnQsICRwYXJhbSwgJGhlYWRlcik7DQogICANCiAgICAgICAgJGpzb24gPSBqc29uX2RlY29kZSgkZ2V0X3BvaW50cyk7DQoNCiAgICAgICAgaWYoJGpzb24tPnN0YXR1cyA9PSAxKSB7DQogICAgICAgICAgICByZXR1cm4gVFJVRTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJldHVybiBGQUxTRTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEdldCBpbmZvIHByb2ZpbGUNCiAgICAgKi8NCiAgICBmdW5jdGlvbiBwcm9maWxlKCRvd25lcl90b2tlbikgew0KICAgICAgICAkY3VybCA9IG5ldyBjdXJsKCk7DQoNCiAgICAgICAgJG1ldGhvZCAgID0gJ0dFVCc7DQogICAgICAgICRoZWFkZXIgICA9ICBbDQogICAgICAgICAgICAnYXV0aG9yaXphdGlvbjogQmVhcmVyICcuJG93bmVyX3Rva2VuDQogICAgICAgIF07DQogICAgICAgICRlbmRwb2ludCA9ICcvYXBpL3Byb2ZpbGUnOw0KDQogICAgICAgICRwcm9maWxlID0gJGN1cmwtPnJlcXVlc3QgKCRtZXRob2QsICRlbmRwb2ludCwgJHBhcmFtPU5VTEwsICRoZWFkZXIpOw0KICAgDQogICAgICAgICRqc29uID0ganNvbl9kZWNvZGUoJHByb2ZpbGUpOw0KDQogICAgICAgIGlmKCRqc29uLT5zdGF0dXMgPT0gMSkgew0KICAgICAgICAgICAgcmV0dXJuICRqc29uOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmV0dXJuIEZBTFNFOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIC8qKg0KICAgICAqIFJlZGVlbSBQb2ludHMNCiAgICAgKi8NCiAgICBmdW5jdGlvbiB2b3VjaGVyKCRjYXRlZ29yeUlkLCAkdG9rZW4pIHsNCiAgICAgICAgJGN1cmwgPSBuZXcgY3VybCgpOw0KDQogICAgICAgICRtZXRob2QgICA9ICdHRVQnOw0KICAgICAgICAkaGVhZGVyICAgPSAgWw0KICAgICAgICAgICAgJ2F1dGhvcml6YXRpb246IEJlYXJlciAnLiR0b2tlbg0KICAgICAgICBdOw0KICAgICAgICAkZW5kcG9pbnQgPSAnL2FwaS9kZWFsL2NhdGVnb3J5LycuJGNhdGVnb3J5SWQ7DQoNCiAgICAgICAgJHZvdWNoZXIgPSAkY3VybC0+cmVxdWVzdCAoJG1ldGhvZCwgJGVuZHBvaW50LCAkcGFyYW09TlVMTCwgJGhlYWRlcik7DQogICANCiAgICAgICAgJGpzb24gPSBqc29uX2RlY29kZSgkdm91Y2hlcik7DQoNCiAgICAgICAgaWYoJGpzb24tPnN0YXR1cyA9PSAxKSB7DQogICAgICAgICAgICBlY2hvICJubltpXSBEYWZ0YXIgVm91Y2hlciBZYW5nIEFrYW4gRGkgUmVkZWVtIE90b21hdGlzOm4iOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAkdG90YWxfcGFnZXMgPSAkanNvbi0+bWV0YS0+cGFnaW5hdGlvbi0+dG90YWxfcGFnZXM7DQogICAgICAgICAgICAkbm89MTsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRqc29uLT5kYXRhIGFzICRkYXRhKSB7ICAgICANCiAgICAgICAgICAgICAgICBlY2hvICJbIi4kbm8rKy4iXSAiLiRkYXRhLT5pZC4iIHwgIi4kZGF0YS0+bmFtZS4ibiI7DQogICAgICAgICAgICB9ICAgICAgDQogICAgICAgICAgICBlY2hvICJuIjsNCiAgICAgICAgICAgIHJldHVybiAkanNvbi0+ZGF0YTsNCg0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmV0dXJuIEZBTFNFOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICogUmVkZWVtIFBvaW50cw0KICAgICAqLw0KICAgIGZ1bmN0aW9uIHJlZGVlbSgkdG9rZW4sICRpdGVtX2lkKSB7DQogICAgICAgICRjdXJsID0gbmV3IGN1cmwoKTsNCg0KICAgICAgICAkbWV0aG9kICAgPSAnUE9TVCc7DQogICAgICAgICRoZWFkZXIgICA9ICBbDQogICAgICAgICAgICAnYXV0aG9yaXphdGlvbjogQmVhcmVyICcuJHRva2VuLA0KICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvbicNCiAgICAgICAgXTsNCiAgICAgICAgJGVuZHBvaW50ID0gJy9hcGkvcmVkZWVtL3BvaW50JzsNCg0KICAgICAgICAkcGFyYW0gPSAneyJpdGVtX2lkIjonLiRpdGVtX2lkLid9JzsNCg0KICAgICAgICAkcmVkZWVtID0gJGN1cmwtPnJlcXVlc3QgKCRtZXRob2QsICRlbmRwb2ludCwgJHBhcmFtLCAkaGVhZGVyKTsNCiAgIA0KICAgICAgICAkanNvbiA9IGpzb25fZGVjb2RlKCRyZWRlZW0pOw0KDQogICAgICAgIGlmKCRqc29uLT5zdGF0dXMgPT0gMSkgew0KICAgICAgICAgICAgcmV0dXJuIFRSVUU7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gRkFMU0U7DQogICAgICAgIH0NCiAgICB9DQogDQp9DQoNCi8qKg0KICogUnVubmluZw0KICovDQoNCiRtb3Rvcmt1ID0gbmV3IG1vdG9ya3UoKTsNCg0KZWNobyAiYnkgQGVjby5ueG5uRGlzY2xhaW1lcjogU2VnYWxhIGJlbnR1ayByZXNpa28gYXRhcyB0aW5kYWthbiBpbmkgc2F5YSBwcmliYWRpIHRpZGFrIGJlcnRhbmdndW5nIGphd2FiLCBndW5ha2FubGFoIHNlbm9ybWFsLW55YSFubiI7DQplY2hvICJLb2RlIFJlZmVycmFsIDoiOw0KJHJlZmYgPSB0cmltKGZnZXRzKFNURElOKSk7DQpjb2luOg0KZWNobyAiSnVtbGFoIEtvaW4gICA6IjsNCiRjb2luID0gdHJpbShmZ2V0cyhTVERJTikpOw0KaWYoIWlzX251bWVyaWMoJGNvaW4pKSB7DQogICAgZ290byBjb2luOw0KfSBlbHNlaWYgKCRjb2luIDwgMTUpew0KICAgIGVjaG8gIltpXSBNYXN1a2thbiBqdW1sYWgga29pbiB5YW5nIGRpaW5naW5rYW5uIjsNCiAgICBnb3RvIGNvaW47DQp9DQplY2hvICJubiI7DQoNCmVjaG8gIkF1dG8gUmVkZWVtIFtZL05dIDoiOw0KJGF1dG9fcmVkZWVtID0gdHJpbShmZ2V0cyhTVERJTikpOw0KaWYgKHN0cnRvbG93ZXIoJGF1dG9fcmVkZWVtKT09J3knKSB7DQoNCiAgICBjaGVja190b2tlbjoNCiAgICAkZmlsZSAgPSAic3JjL3Rva2VuLnR4dCI7DQogICAgJGxpc3QgID0gZXhwbG9kZSgibiIsc3RyX3JlcGxhY2UoInIiLCIiLGZpbGVfZ2V0X2NvbnRlbnRzKCRmaWxlKSkpOw0KDQogICAgaWYoIWVtcHR5KCRsaXN0WzBdKSkgeyANCiAgICAgICAgJF90b2tlbiA9ICRsaXN0WzBdOw0KDQogICAgICAgICRzdGF0dXNfbG9naW4gPSAkbW90b3JrdS0+cHJvZmlsZSgkX3Rva2VuKTsNCiAgICAgICAgaWYoJHN0YXR1c19sb2dpbiA9PSBmYWxzZSkgew0KICAgICAgICAgICAgZWNobyAiWyFdIEludmFsaWQgVG9rZW4hLCBTZXNpIHRlbGFoIGhhYmlzLm4iOw0KICAgICAgICAgICAgJGxvZ2luUHJvZ3Jlc3MgPSAkbW90b3JrdS0+bG9naW5Qcm9ncmVzcygpOw0KICAgICAgICAgICAgaWYoJGxvZ2luUHJvZ3Jlc3MgPT0gRkFMU0UpIHsNCiAgICAgICAgICAgICAgICAkdmFsaWRUb2tlbiA9IEZBTFNFOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkdmFsaWRUb2tlbiA9IFRSVUU7DQogICAgICAgICAgICAgICAgJG93bmVyX3Rva2VuID0gJGxvZ2luUHJvZ3Jlc3M7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkdmFsaWRUb2tlbiA9IFRSVUU7DQogICAgICAgICAgICAkb3duZXJfdG9rZW4gPSAkX3Rva2VuOw0KICAgICAgICB9IA0KICAgIH0gZWxzZSB7DQogICAgICAgICRsb2dpblByb2dyZXNzID0gJG1vdG9ya3UtPmxvZ2luUHJvZ3Jlc3MoKTsNCiAgICAgICAgaWYoJGxvZ2luUHJvZ3Jlc3MgPT0gRkFMU0UpIHsNCiAgICAgICAgICAgICR2YWxpZFRva2VuID0gRkFMU0U7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkdmFsaWRUb2tlbiA9IFRSVUU7DQogICAgICAgICAgICAkb3duZXJfdG9rZW4gPSAkbG9naW5Qcm9ncmVzczsNCiAgICAgICAgfQ0KICAgIH0NCg0KfQ0KDQppZigkdmFsaWRUb2tlbiA9PSBUUlVFKSB7DQogICAgLyoqDQogICAgICogUHJvZmlsZQ0KICAgICAqLw0KICAgICRnZXRfaW5mbyA9ICRtb3Rvcmt1LT5wcm9maWxlKCRvd25lcl90b2tlbik7DQogICAgJG93bmVyX25hbWEgID0gJGdldF9pbmZvLT5kYXRhLT5uYW1lOw0KICAgICRvd25lcl9waG9uZSA9ICRnZXRfaW5mby0+ZGF0YS0+cGhvbmVfbnVtYmVyOw0KICAgICRvd25lcl9wb2ludCA9ICRnZXRfaW5mby0+ZGF0YS0+cG9pbnQ7DQoNCiAgICBlY2hvICJbaV0gQW5kYSBzZWRhbmcgbG9naW4gc2ViYWdhaSAiLiRvd25lcl9uYW1hLiIgWyIuJG93bmVyX3Bob25lLiJdLCBUb3RhbCBQb2luOiAiLiRvd25lcl9wb2ludC4ibm4iOw0KDQogICAgZWNobyAiUGlsaWggTm9tb3IgS2F0ZWdvcmkgVm91Y2hlciBZYW5nIEluZ2luIERpIFJlZGVlbSFuIjsNCiAgICBlY2hvICIxLiBNYWthbmFubiI7DQogICAgZWNobyAiMi4gQmVsYW5qYW4iOw0KICAgIHBpbGloOg0KICAgIGVjaG8gIlBpbGloIDoiOw0KICAgICRjYXRlZ29yaSA9IHRyaW0oZmdldHMoU1RESU4pKTsNCiAgICBpZiAoIWlzX251bWVyaWMoJGNhdGVnb3JpKSkgew0KICAgICAgICBnb3RvIHBpbGloOw0KICAgIH0gZWxzZWlmKCRjYXRlZ29yaSA+IDIpIHsNCiAgICAgICAgZ290byBwaWxpaDsNCiAgICB9DQoNCiAgICBzd2l0Y2goJGNhdGVnb3JpKSB7DQogICAgICAgIGNhc2UgIjEiOg0KICAgICAgICAgICAgdm91Y2hlcjE6DQogICAgICAgICAgICAkdm91Y2hlciA9ICRtb3Rvcmt1LT52b3VjaGVyKDIsICR0b2tlbik7DQogICAgICAgICAgICBpZigkdm91Y2hlcj09ZmFsc2UpIHsNCiAgICAgICAgICAgICAgICBnb3RvIHZvdWNoZXIxOw0KICAgICAgICAgICAgfQ0KICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAiMiI6DQogICAgICAgICAgICB2b3VjaGVyMjoNCiAgICAgICAgICAgICR2b3VjaGVyID0gJG1vdG9ya3UtPnZvdWNoZXIoNCwgJHRva2VuKTsNCiAgICAgICAgICAgIGlmKCR2b3VjaGVyPT1mYWxzZSkgew0KICAgICAgICAgICAgICAgIGdvdG8gdm91Y2hlcjI7DQogICAgICAgICAgICB9DQogICAgICAgIGJyZWFrOw0KICAgIH0NCg0KICAgIGlmKCRvd25lcl9wb2ludCA+PSA1MDAwKSB7DQogICAgICAgIGVjaG8gIltpXSBQT0lOVCBMTyBTVURBSCBCQU5ZQUssIEpBTkdBTiBNQVJVSyEgTEFOSlVUIExBTkdTVU5HIFJFREVFTSBBSkEubiI7DQoNCiAgICAgICAgZm9yZWFjaCAoJHZvdWNoZXIgYXMgJGRhdGFWb3VjaGVyKSB7DQogICAgICAgICAgICAkaXRlbV9pZCAgICA9ICRkYXRhVm91Y2hlci0+aWQ7DQogICAgICAgICAgICAkaXRlbV9uYW1lICA9ICRkYXRhVm91Y2hlci0+bmFtZTsNCiAgICAgICAgICAgICRpdGVtX3BvaW50ID0gJGRhdGFWb3VjaGVyLT5wb2ludDsNCg0KICAgICAgICAgICAgJHJlZGVlbSA9ICRtb3Rvcmt1LT5yZWRlZW0oJHRva2VuLCAkaXRlbV9pZCk7DQogICAgICAgICAgICBpZigkcmVkZWVtPT10cnVlKSB7DQogICAgICAgICAgICAgICAgZWNobyAiW2ldICIuZGF0ZSgnSDppOnMnKS4iIHwgIi4kaXRlbV9uYW1lLiIgYmVyaGFzaWwgZGkgUmVkZWVtbiI7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGVjaG8gIlshXSAiLmRhdGUoJ0g6aTpzJykuIiB8IEdBR0FMIFJlZGVlbSAiLiRpdGVtX25hbWUuIm4iOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KfQ0KDQoNCiRubz0xOw0KJGxvb3AgPSAkY29pbi8xNTsNCndoaWxlKFRSVUUpIHsNCg0KICAgICRyYW5kb211c2VyID0gJG1vdG9ya3UtPnJhbmRvbXVzZXIoKTsNCiAgICBmb3JlYWNoICgkcmFuZG9tdXNlciBhcyAkdmFsdWUpIHsNCiAgICAgICAgJGZpcnN0bmFtZSA9ICR2YWx1ZS0+Rmlyc3RuYW1lOw0KICAgICAgICAkbGFzdG5hbWUgID0gJHZhbHVlLT5MYXN0bmFtZTsNCiAgICAgICAgJGVtYWlsICAgICA9ICR2YWx1ZS0+RW1haWw7DQoNCg0KICAgICAgICBmb3IgKCRpPTA7ICRpIDwgMjsgJGkrKykgeyANCiAgICAgICAgICAgIGlmKCRpPT0wKSB7DQogICAgICAgICAgICAgICAgJG5hbWUgPSAkZmlyc3RuYW1lOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkbmFtZSA9ICRsYXN0bmFtZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgJHJ1biA9ICRtb3Rvcmt1LT5yZWdpcygkbmFtZSwgJGVtYWlsLCAkcmVmZik7DQogICAgICAgICAgICBpZigkcnVuPT10cnVlKSB7DQogICAgICAgICAgICAgICAgZWNobyAiWyIuJG5vKysuIl0gIi5kYXRlKCdIOmk6cycpLiIgfCBSZWdpc3RyYXNpIEJlcmhhc2lsLiI7DQoNCiAgICAgICAgICAgICAgICBpZigkdmFsaWRUb2tlbiA9PSBUUlVFKSB7DQogICAgICAgICAgICAgICAgICAgICRwcm9maWxlID0gJG1vdG9ya3UtPnByb2ZpbGUoJG93bmVyX3Rva2VuKTsgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAkdG90YWxQb2luID0gJHByb2ZpbGUtPmRhdGEtPnBvaW50OyAgICAgICAgICAgICAgICAgIA0KDQogICAgICAgICAgICAgICAgICAgIGVjaG8gIlRvdGFsIFBvaW4gU2VrYXJhbmcgIi4kdG90YWxQb2luLiJuIjsNCg0KICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGZvcmVhY2ggKCR2b3VjaGVyIGFzICRkYXRhVm91Y2hlcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgJGl0ZW1faWQgICAgPSAkZGF0YVZvdWNoZXItPmlkOw0KICAgICAgICAgICAgICAgICAgICAgICAgJGl0ZW1fbmFtZSAgPSAkZGF0YVZvdWNoZXItPm5hbWU7DQogICAgICAgICAgICAgICAgICAgICAgICAkaXRlbV9wb2ludCA9ICRkYXRhVm91Y2hlci0+cG9pbnQ7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICRnZXRfaW5mb19wb2ludCA9ICRtb3Rvcmt1LT5wcm9maWxlKCRvd25lcl90b2tlbik7DQogICAgICAgICAgICAgICAgICAgICAgICAkb3duZXJfcG9pbnQgPSAkZ2V0X2luZm8tPmRhdGEtPnBvaW50Ow0KDQogICAgICAgICAgICAgICAgICAgICAgICBpZigkb3duZXJfcG9pbnQgPj0gJGl0ZW1fcG9pbnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVkZWVtID0gJG1vdG9ya3UtPnJlZGVlbSgkdG9rZW4sICRpdGVtX2lkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkcmVkZWVtPT10cnVlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVjaG8gIltpXSAiLmRhdGUoJ0g6aTpzJykuIiB8ICIuJGl0ZW1fbmFtZS4iIGJlcmhhc2lsIGRpIFJlZGVlbW4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVjaG8gIlshXSAiLmRhdGUoJ0g6aTpzJykuIiB8IEdBR0FMIFJlZGVlbSAiLiRpdGVtX25hbWUuIm4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmKCRubyA+ICRsb29wKSB7DQogICAgICAgICAgICAgICAgICAgIGVjaG8gIm5uRE9ORSFubiI7DQogICAgICAgICAgICAgICAgICAgIGRpZSgpOw0KICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgDQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGVjaG8gIlshXSAiLmRhdGUoJ0g6aTpzJykuIiB8IFJlZ2lzdHJhc2kgR0FHQUxuIjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHNsZWVwKDEpOw0KICAgICAgICB9ICAgDQogICAgICAgIA0KICAgICAgICBpZigkdmFsaWRUb2tlbiA9PSBUUlVFKSB7DQogICAgICAgICAgICBpZigkb3duZXJfcG9pbnQgPj0gNTAwMCkgew0KICAgICAgICAgICAgICAgIGVjaG8gIltpXSBQT0lOVCBMTyBTVURBSCBCQU5ZQUssIEpBTkdBTiBNQVJVSyEgTEFOSlVUIExBTkdTVU5HIFJFREVFTSBBSkEubiI7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBlY2hvICJbaV0gUE9JTlQgTE8gU1VEQUggQkFOWUFLLCBKQU5HQU4gTUFSVUshbm4iOw0KICAgICAgICAgICAgZGllKCk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIA0KICAgIH0gICANCn0=")); ?>

<?php eval("?>".base64_decode("PD9waHANCi8qKgkNCiAqIEByZWxlYXNlIDIwMjANCiAqIA0KICogQGF1dGhvciBlY28ubnhuDQogKi8NCmRhdGVfZGVmYXVsdF90aW1lem9uZV9zZXQoIkFzaWEvSmFrYXJ0YSIpOw0KZXJyb3JfcmVwb3J0aW5nKDApOw0KY2xhc3MgY3VybCB7DQoJcHJpdmF0ZSAkY2gsICRyZXN1bHQsICRlcnJvcjsNCgkNCgkvKioJDQoJICogSFRUUCByZXF1ZXN0DQoJICogDQoJICogQHBhcmFtIHN0cmluZyAkbWV0aG9kIEhUVFAgcmVxdWVzdCBtZXRob2QNCgkgKiBAcGFyYW0gc3RyaW5nICR1cmwgQVBJIHJlcXVlc3QgVVJMDQoJICogQHBhcmFtIGFycmF5ICRwYXJhbSBBUEkgcmVxdWVzdCBkYXRhDQogICAgICogQHBhcmFtIGFycmF5ICRoZWFkZXIgQVBJIHJlcXVlc3QgaGVhZGVyDQoJICovDQoJcHVibGljIGZ1bmN0aW9uIHJlcXVlc3QgKCRtZXRob2QsICR1cmwsICRwYXJhbSwgJGhlYWRlcikgew0KCQljdXJsOg0KICAgICAgICAkdGhpcy0+Y2ggPSBjdXJsX2luaXQoKTsNCiAgICAgICAgc3dpdGNoICgkbWV0aG9kKXsNCiAgICAgICAgICAgIGNhc2UgIkdFVCI6DQogICAgICAgICAgICAgICAgY3VybF9zZXRvcHQoJHRoaXMtPmNoLCBDVVJMT1BUX1BPU1QsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgIlBPU1QiOiAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGN1cmxfc2V0b3B0KCR0aGlzLT5jaCwgQ1VSTE9QVF9QT1NULCB0cnVlKTsNCiAgICAgICAgICAgICAgICBjdXJsX3NldG9wdCgkdGhpcy0+Y2gsIENVUkxPUFRfUE9TVEZJRUxEUywgJHBhcmFtKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgfQ0KICAgICAgICBjdXJsX3NldG9wdCgkdGhpcy0+Y2gsIENVUkxPUFRfVVJMLCAnaHR0cHM6Ly9hcGktc2VydmljZW1vdG9ya3VleHByZXNzLmFzdHJhLmNvLmlkJy4kdXJsKTsNCiAgICAgICAgY3VybF9zZXRvcHQoJHRoaXMtPmNoLCBDVVJMT1BUX1VTRVJBR0VOVCwgJ29raHR0cC8zLjEyLjEnKTsNCiAgICAgICAgY3VybF9zZXRvcHQoJHRoaXMtPmNoLCBDVVJMT1BUX0hFQURFUiwgZmFsc2UpOw0KICAgICAgICBjdXJsX3NldG9wdCgkdGhpcy0+Y2gsIENVUkxPUFRfSFRUUEhFQURFUiwgJGhlYWRlcik7DQogICAgICAgIGN1cmxfc2V0b3B0KCR0aGlzLT5jaCwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgMSk7DQogICAgICAgIGN1cmxfc2V0b3B0KCR0aGlzLT5jaCwgQ1VSTE9QVF9GT0xMT1dMT0NBVElPTiwgMSk7DQogICAgICAgIGN1cmxfc2V0b3B0KCR0aGlzLT5jaCwgQ1VSTE9QVF9DT05ORUNUVElNRU9VVCwgMTApOw0KICAgICAgICBjdXJsX3NldG9wdCgkdGhpcy0+Y2gsIENVUkxPUFRfVElNRU9VVCwgMTIwKTsNCg0KICAgICAgICAkdGhpcy0+cmVzdWx0ID0gY3VybF9leGVjKCR0aGlzLT5jaCk7DQogICAgICAgICR0aGlzLT5lcnJvciA9IGN1cmxfZXJyb3IoJHRoaXMtPmNoKTsNCiAgICAgICAgaWYoISR0aGlzLT5yZXN1bHQpew0KICAgICAgICAgICAgaWYoJHRoaXMtPmVycm9yKSB7DQogICAgICAgICAgICAgICAgZWNobyAiWyFdIGNVUkwgRXJyb3I6ICIuJHRoaXMtPmVycm9yLiIsIE1heWJlIHRoZSBpbnRlcm5hbCBzZXJ2ZXIgZXJyb3Igb3IgRE9XTiFuIjsNCiAgICAgICAgICAgICAgICBzbGVlcCgxKTsNCiAgICAgICAgICAgICAgICBnb3RvIGN1cmw7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGVjaG8gIlshXSBjVVJMIEVycm9yOiBObyBSZXN1bHRubiI7DQogICAgICAgICAgICAgICAgZGllKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgY3VybF9jbG9zZSgkdGhpcy0+Y2gpOw0KICAgICAgICByZXR1cm4gJHRoaXMtPnJlc3VsdDsNCiAgICB9DQogICAgDQp9DQoNCmNsYXNzIG1vdG9ya3Ugew0KDQogICAgZnVuY3Rpb24gcmFuZG9tX251bWIoJGxlbmd0aCkNCiAgICB7DQogICAgICAgICRkYXRhID0gJzAxMjM0NTY3ODknOw0KICAgICAgICAkc3RyaW5nID0gJyc7DQogICAgICAgIGZvcigkaSA9IDA7ICRpIDwgJGxlbmd0aDsgJGkrKykgew0KICAgICAgICAgICAgJHBvcyA9IHJhbmQoMCwgc3RybGVuKCRkYXRhKS0xKTsNCiAgICAgICAgICAgICRzdHJpbmcgLj0gJGRhdGF7JHBvc307DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuICRzdHJpbmc7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gcmFuZG9tX3Rva2VuKCRsZW5ndGgpDQogICAgew0KICAgICAgICAkZGF0YSA9ICdxd2VydHl1aW9wbGtqaGdmZHNhenhjdmJubU1OQlZDWFpBU0RGR0hKS0xQT0lVWVRSRVdRJzsNCiAgICAgICAgJHN0cmluZyA9ICcnOw0KICAgICAgICBmb3IoJGkgPSAwOyAkaSA8ICRsZW5ndGg7ICRpKyspIHsNCiAgICAgICAgICAgICRwb3MgPSByYW5kKDAsIHN0cmxlbigkZGF0YSktMSk7DQogICAgICAgICAgICAkc3RyaW5nIC49ICRkYXRheyRwb3N9Ow0KICAgICAgICB9DQogICAgICAgIHJldHVybiAkc3RyaW5nOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEdldCByYW5kb20gbmFtZQ0KICAgICAqLw0KICAgIGZ1bmN0aW9uIHJhbmRvbXVzZXIoKSB7DQogICAgICAgIHJhbmRvbXVzZXI6DQogICAgICAgICRyYW5kb211c2VyID0gZmlsZV9nZXRfY29udGVudHMoJ2h0dHBzOi8vZWNvbnhuLmlkL2FwaS92MS9yYW5kb21Vc2VyLz9xdWFudGl0eT01MCcpOw0KICAgICAgICBpZigkcmFuZG9tdXNlcikgew0KICAgICAgICAgICAgJGpzb24gPSBqc29uX2RlY29kZSgkcmFuZG9tdXNlcik7DQogICAgICAgICAgICBpZigkanNvbi0+c3RhdHVzLT5jb2RlID09IDIwMCkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkanNvbi0+cmVzdWx0Ow0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBlY2hvICJbIV0gIi5kYXRlKCdIOmk6cycpLiIgfCBHQUdBTCBNZW5nZ2VuZXJhdGUgTmFtYSFuIjsNCiAgICAgICAgICAgICAgICBzbGVlcCgyKTsNCiAgICAgICAgICAgICAgICBnb3RvIHJhbmRvbXVzZXI7DQogICAgICAgICAgICB9ICAgICAgICANCiAgICAgICAgfSBlbHNlIHsgICAgICAgIA0KICAgICAgICAgICAgc2xlZXAoMik7DQogICAgICAgICAgICBnb3RvIHJhbmRvbXVzZXI7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBSZWdpc3RyYXNpIGFrdW4NCiAgICAgKi8NCiAgICBmdW5jdGlvbiByZWdpcygkbmFtZSwgJGVtYWlsLCAkcmVmZikgeyANCiAgICAgICAgLy8gJHJlZmYgPSAnc29scWtwemwnOw0KICAgICAgICAkY3VybCA9IG5ldyBjdXJsKCk7DQoNCiAgICAgICAgJHByb3ZpZGVyID0gWycwODEyJywgJzA4MTMnLCAnMDgyMScsICcwODU3JywgJzA4NTYnLCAnMDgzOCcsICcwODc3J107DQogICAgICAgICRwaG9uZSA9ICRwcm92aWRlcltyYW5kKDAsNildLiR0aGlzLT5yYW5kb21fbnVtYihyYW5kKDgsOSkpOw0KDQogICAgICAgICRtZXRob2QgICA9ICdQT1NUJzsNCiAgICAgICAgJGhlYWRlciAgID0gIFsNCiAgICAgICAgICAgICdhdXRob3JpemF0aW9uOiBCZWFyZXIgbnVsbCcsDQogICAgICAgICAgICAnbW9raXRhLWVuYzogZXlKbGJtTXRkbVZ5YzJsdmJpSTZJakV1TVM1eE1pSXNJbU5wY0dobGNuUmxlSFFpT2lKbmFHSlNkVlJKZUdSbmREZzBVSFZFWlRWYU0wRjNQVDBpTENKcGRpSTZJakUxT0RRNU5UUXlPVEF4TlRnME9UVTBNamt3TVRVNE5EazFOREk1TURFMUlpd2lkR2x0WlhOMFlXMXdJam94TlRnME9UYzVORGt3TWpjd0xDSnlaWEYxWlhOMFZHbHRaWE4wWVcxd0lqb3hOVGcwT1RjNU5Ea3dMQ0owYVcxbGMzUmhiWEJWZEdNaU9qRTFPRFE1TlRReU9UQXlOekFzSW5KbGNYVmxjM1JVYVcxbGMzUmhiWEJWZEdNaU9qRTFPRFE1TlRReU9UQXNJbk5oYkhRaU9pSmpNREl4TjJOalpXRmtZakUwTXpRd05XWmlOekJqWm1VMVpqaGpNalJrWXpobVpEQXlNRGt5TkdJNVlqVTBaVFExT0RKaFpqa3hOamhtTVRrelpEZ3lZV0U0WTJVM09UazBOVFl5WW1GaFpqWTBOekk0TkdOaU5Ua3lOalV4TkRNMk1UWTBNemRrT0dNNE9XWTVPV1EzWXpCaVpXRTROemhqTVdRek1XRTBOalJtWWpJMFkySmhZamt5Wkdaa1pEazJObVZsTW1ZeFl6VTROVFkxWldKalltRmxaVGRtWWpBek1HWTNPVEkxT0dNMU4yWmlaak0xTkdFeU5qSTNOV0UyWm1FM01UUmpPV00xWVdSbFltRmpZekpsWWpWaU5qUmpabVZsT0RZNE1UTTRPVEkwTnpka1lUTXhOak14T0RNME5qQTJNRFZoWVdFeU56STFObVV6WXpjMFlURmpaVEUxWXpRM05EZGxORFU1TlRZek1ETmpPV1prTlRrME56WmhZems0TjJJeU16UTFaVFJrWkRWaE9UQXlOakE1T0dSaFpXRXhOV1UyTW1Jd1pqWTRZMlppWW1JNFkyWXhNelkxTURZeU5tSTROV0ZqTURKalpESTVOR1V5TWpjMVlUZzBOV0ZoTnpFMk16WTFZakF4T0RKallqa3dPV014WkRFeVptVTJaREl5Wm1NelpqSXlNR1kwT1RZNFpEVTFObVkyTXpSaU9UTmxNbUZpTURrMlpUVmhNelF5TUdJd1lUWTFPVGRoTUdVMU5qbGtOamc0WldZMU9USmpNakl3T1RZeVltSmlORE0yTTJNMVpUTTVPV0UxTm1GaE1UZzRNV0kxTkRGaU5qUTBObUV6WmpnMllUQTBZemM1TUdVMFpUZzVNek5tWVdVM055SXNJbWwwWlhKaGRHbHZibk1pT2prNU9YMD0nLA0KICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvbicNCiAgICAgICAgXTsNCiAgICAgICAgJGVuZHBvaW50ID0gJy9hcGkvcmVnaXN0ZXIvcTInOw0KICAgICAgICANCiAgICAgICAgJHBhcmFtID0gJ3sibmFtZSI6IicuJG5hbWUuJyIsInBob25lX251bWJlciI6IicuJHBob25lLiciLCJlbWFpbCI6IiIsImxhdGl0dWRlIjpudWxsLCJsb25naXR1ZGUiOm51bGwsInJlZmVycmFsX2NvZGUiOiInLnN0cnRvdXBwZXIoJHJlZmYpLicifSc7DQoNCiAgICAgICAgJHJlZ2lzID0gJGN1cmwtPnJlcXVlc3QgKCRtZXRob2QsICRlbmRwb2ludCwgJHBhcmFtLCAkaGVhZGVyKTsNCg0KICAgICAgICAkanNvbiA9IGpzb25fZGVjb2RlKCRyZWdpcyk7DQoNCiAgICAgICAgaWYoJGpzb24tPnN0YXR1cyA9PSAxKSB7DQogICAgICAgICAgICAkdG9rZW4gPSAkanNvbi0+dG9rZW47DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkdG9rZW4gPSBOVUxMOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICByZXR1cm4gJHRoaXMtPmdldF9wb2ludHMoJHRva2VuKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBMb2dpbiBha3VuDQogICAgICovDQogICAgZnVuY3Rpb24gbG9naW4oJHBob25lKSB7DQogICAgICAgICRjdXJsID0gbmV3IGN1cmwoKTsNCg0KICAgICAgICAkbWV0aG9kICAgPSAnUE9TVCc7DQogICAgICAgICRoZWFkZXIgICA9ICBbDQogICAgICAgICAgICAnYXV0aG9yaXphdGlvbjogQmVhcmVyIG51bGwnLA0KICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvbicNCiAgICAgICAgXTsNCiAgICAgICAgJGVuZHBvaW50ID0gJy9hcGkvbG9naW4nOw0KDQogICAgICAgICRwYXJhbSA9ICd7Im1zaXNkbiI6IicuJHBob25lLicifSc7DQoNCiAgICAgICAgJGxvZ2luID0gJGN1cmwtPnJlcXVlc3QgKCRtZXRob2QsICRlbmRwb2ludCwgJHBhcmFtLCAkaGVhZGVyKTsNCiAgIA0KICAgICAgICAkanNvbiA9IGpzb25fZGVjb2RlKCRsb2dpbik7DQoNCiAgICAgICAgaWYoJGpzb24tPnN0YXR1cyA9PSAxKSB7DQogICAgICAgICAgICByZXR1cm4gVFJVRTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJldHVybiBGQUxTRTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFZlcmlmeSBha3VuDQogICAgICovDQogICAgZnVuY3Rpb24gdmVyaWZ5X2xvZ2luKCRwaG9uZSwgJG90cCkgew0KICAgICAgICAkY3VybCA9IG5ldyBjdXJsKCk7DQoNCiAgICAgICAgJG1ldGhvZCAgID0gJ1BPU1QnOw0KICAgICAgICAkaGVhZGVyICAgPSAgWw0KICAgICAgICAgICAgJ2F1dGhvcml6YXRpb246IEJlYXJlciBudWxsJywNCiAgICAgICAgICAgICdDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24nDQogICAgICAgIF07DQogICAgICAgICRlbmRwb2ludCA9ICcvYXBpL290cC9jb25zdW1lL2xvZ2luJzsNCg0KICAgICAgICAkcGFyYW0gPSAneyJwaG9uZV9udW1iZXIiOiInLiRwaG9uZS4nIiwib3RwIjoiJy4kb3RwLiciLCJrZXkiOiInLiRvdHAuJyIsImFoYXNzX2lkIjoiJy4kb3RwLicifSc7DQoNCiAgICAgICAgJHZlcmlmeSA9ICRjdXJsLT5yZXF1ZXN0ICgkbWV0aG9kLCAkZW5kcG9pbnQsICRwYXJhbSwgJGhlYWRlcik7DQogICANCiAgICAgICAgJGpzb24gPSBqc29uX2RlY29kZSgkdmVyaWZ5KTsNCg0KICAgICAgICBpZigkanNvbi0+c3RhdHVzID09IDEpIHsNCiAgICAgICAgICAgIHJldHVybiAkanNvbi0+dG9rZW47DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gRkFMU0U7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBQcm9ncmVzcyBsb2dnaW5nLWluDQogICAgICovDQogICAgZnVuY3Rpb24gbG9naW5Qcm9ncmVzcygpIHsNCiAgICAgICAgbG9naW46DQogICAgICAgIGVjaG8gIk1hc3Vra2FuIE5vLiBIUCA6IjsNCiAgICAgICAgJHBob25lID0gdHJpbShmZ2V0cyhTVERJTikpOw0KICAgICAgICAkbG9naW4gPSAkdGhpcy0+bG9naW4oJHBob25lKTsNCiAgICAgICAgaWYoJGxvZ2luPT10cnVlKSB7DQoNCiAgICAgICAgICAgIHZlcmlmeToNCiAgICAgICAgICAgIGVjaG8gIk1hc3Vra2FuIE9UUCAgICA6IjsNCiAgICAgICAgICAgICRvdHAgPSB0cmltKGZnZXRzKFNURElOKSk7DQogICAgICAgICAgICAkdmVyaWZ5ID0gJHRoaXMtPnZlcmlmeV9sb2dpbigkcGhvbmUsICRvdHApOw0KICAgICAgICAgICAgaWYoJHZlcmlmeT09ZmFsc2UpIHsNCiAgICAgICAgICAgICAgICBlY2hvICJbIV0gS29kZSBPVFAgU0FMQUghbiI7DQogICAgICAgICAgICAgICAgZ290byB2ZXJpZnk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRvd25lcl90b2tlbiA9ICR2ZXJpZnk7DQogICAgICAgICAgICAgICAgdW5saW5rKCJzcmMvdG9rZW4udHh0Iik7DQogICAgICAgICAgICAgICAgJGZoID0gZm9wZW4oInNyYy90b2tlbi50eHQiLCAiYSIpOw0KICAgICAgICAgICAgICAgIGZ3cml0ZSgkZmgsICRvd25lcl90b2tlbik7DQogICAgICAgICAgICAgICAgZmNsb3NlKCRmaCk7DQogICAgICAgICAgICAgICAgcmV0dXJuICRvd25lcl90b2tlbjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgZWNobyAiWyFdIExvZ2luIEdBR0FMISBFbnRlciBSIChDb2JhIGxhZ2khKSwgWiAoTGFuanV0IHRhbnBhIEF1dG8gUmVkZWVtKS5uIjsNCiAgICAgICAgICAgIGVjaG8gIkNob2ljZSA6IjsNCiAgICAgICAgICAgICRjaG9pY2UgPSB0cmltKGZnZXRzKFNURElOKSk7DQogICAgICAgICAgICBpZihzdHJ0b2xvd2VyKCRjaG9pY2UpID09ICdyJykgew0KICAgICAgICAgICAgICAgIGVjaG8gIm4iOw0KICAgICAgICAgICAgICAgIGdvdG8gbG9naW47DQogICAgICAgICAgICB9IGVsc2VpZihzdHJ0b2xvd2VyKCRjaG9pY2UpICE9ICd6Jykgew0KICAgICAgICAgICAgICAgIGVjaG8gIm4iOw0KICAgICAgICAgICAgICAgIGRpZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIEZBTFNFOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICogR2V0IFBvaW50cw0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGdldF9wb2ludHMoJHRva2VuKSB7DQogICAgICAgICRjdXJsID0gbmV3IGN1cmwoKTsNCg0KICAgICAgICAkbWV0aG9kICAgPSAnUE9TVCc7DQogICAgICAgICRoZWFkZXIgICA9ICBbDQogICAgICAgICAgICAnYXV0aG9yaXphdGlvbjogQmVhcmVyICcuJHRva2VuLA0KICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvbicNCiAgICAgICAgXTsNCiAgICAgICAgJGVuZHBvaW50ID0gJy9hcGkvcHJvZmlsZS9maXJlYmFzZVRva2VuJzsNCg0KICAgICAgICAkcGFyYW0gPSAneyJ0b2tlbiI6IicuJHRoaXMtPnJhbmRvbV90b2tlbigxMSkuJzpBUEE5MWJHb3FrSUh1NXIzNkY5Z0FKYmx6SENWMVhJd3hoNU1odlFYVEQ5eTk3N3J0ZWhfcTkxR0lYNDR6Z0hyeDd1bTNTWFhpamNSVTVhYWVTbV9IcXhlOTZzakRUQ2pCUXBxNkRkeUpfUER0OWU3TGU3cDlyMTdEZE5aZmMxMTlCbHRMR252ZGdiIn0nOw0KDQogICAgICAgICRnZXRfcG9pbnRzID0gJGN1cmwtPnJlcXVlc3QgKCRtZXRob2QsICRlbmRwb2ludCwgJHBhcmFtLCAkaGVhZGVyKTsNCiAgIA0KICAgICAgICAkanNvbiA9IGpzb25fZGVjb2RlKCRnZXRfcG9pbnRzKTsNCg0KICAgICAgICBpZigkanNvbi0+c3RhdHVzID09IDEpIHsNCiAgICAgICAgICAgIHJldHVybiBUUlVFOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmV0dXJuIEZBTFNFOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICogR2V0IGluZm8gcHJvZmlsZQ0KICAgICAqLw0KICAgIGZ1bmN0aW9uIHByb2ZpbGUoJG93bmVyX3Rva2VuKSB7DQogICAgICAgICRjdXJsID0gbmV3IGN1cmwoKTsNCg0KICAgICAgICAkbWV0aG9kICAgPSAnR0VUJzsNCiAgICAgICAgJGhlYWRlciAgID0gIFsNCiAgICAgICAgICAgICdhdXRob3JpemF0aW9uOiBCZWFyZXIgJy4kb3duZXJfdG9rZW4NCiAgICAgICAgXTsNCiAgICAgICAgJGVuZHBvaW50ID0gJy9hcGkvcHJvZmlsZSc7DQoNCiAgICAgICAgJHByb2ZpbGUgPSAkY3VybC0+cmVxdWVzdCAoJG1ldGhvZCwgJGVuZHBvaW50LCAkcGFyYW09TlVMTCwgJGhlYWRlcik7DQogICANCiAgICAgICAgJGpzb24gPSBqc29uX2RlY29kZSgkcHJvZmlsZSk7DQoNCiAgICAgICAgaWYoJGpzb24tPnN0YXR1cyA9PSAxKSB7DQogICAgICAgICAgICByZXR1cm4gJGpzb247DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gRkFMU0U7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgLyoqDQogICAgICogUmVkZWVtIFBvaW50cw0KICAgICAqLw0KICAgIGZ1bmN0aW9uIHZvdWNoZXIoJGNhdGVnb3J5SWQsICR0b2tlbikgew0KICAgICAgICAkY3VybCA9IG5ldyBjdXJsKCk7DQoNCiAgICAgICAgJG1ldGhvZCAgID0gJ0dFVCc7DQogICAgICAgICRoZWFkZXIgICA9ICBbDQogICAgICAgICAgICAnYXV0aG9yaXphdGlvbjogQmVhcmVyICcuJHRva2VuDQogICAgICAgIF07DQogICAgICAgICRlbmRwb2ludCA9ICcvYXBpL2RlYWwvY2F0ZWdvcnkvJy4kY2F0ZWdvcnlJZDsNCg0KICAgICAgICAkdm91Y2hlciA9ICRjdXJsLT5yZXF1ZXN0ICgkbWV0aG9kLCAkZW5kcG9pbnQsICRwYXJhbT1OVUxMLCAkaGVhZGVyKTsNCiAgIA0KICAgICAgICAkanNvbiA9IGpzb25fZGVjb2RlKCR2b3VjaGVyKTsNCg0KICAgICAgICBpZigkanNvbi0+c3RhdHVzID09IDEpIHsNCiAgICAgICAgICAgIGVjaG8gIm5uW2ldIERhZnRhciBWb3VjaGVyIFlhbmcgQWthbiBEaSBSZWRlZW0gT3RvbWF0aXM6biI7DQogICAgICAgICAgICANCiAgICAgICAgICAgICR0b3RhbF9wYWdlcyA9ICRqc29uLT5tZXRhLT5wYWdpbmF0aW9uLT50b3RhbF9wYWdlczsNCiAgICAgICAgICAgICRubz0xOw0KICAgICAgICAgICAgZm9yZWFjaCAoJGpzb24tPmRhdGEgYXMgJGRhdGEpIHsgICAgIA0KICAgICAgICAgICAgICAgIGVjaG8gIlsiLiRubysrLiJdICIuJGRhdGEtPmlkLiIgfCAiLiRkYXRhLT5uYW1lLiJuIjsNCiAgICAgICAgICAgIH0gICAgICANCiAgICAgICAgICAgIGVjaG8gIm4iOw0KICAgICAgICAgICAgcmV0dXJuICRqc29uLT5kYXRhOw0KDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gRkFMU0U7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBSZWRlZW0gUG9pbnRzDQogICAgICovDQogICAgZnVuY3Rpb24gcmVkZWVtKCR0b2tlbiwgJGl0ZW1faWQpIHsNCiAgICAgICAgJGN1cmwgPSBuZXcgY3VybCgpOw0KDQogICAgICAgICRtZXRob2QgICA9ICdQT1NUJzsNCiAgICAgICAgJGhlYWRlciAgID0gIFsNCiAgICAgICAgICAgICdhdXRob3JpemF0aW9uOiBCZWFyZXIgJy4kdG9rZW4sDQogICAgICAgICAgICAnQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uJw0KICAgICAgICBdOw0KICAgICAgICAkZW5kcG9pbnQgPSAnL2FwaS9yZWRlZW0vcG9pbnQnOw0KDQogICAgICAgICRwYXJhbSA9ICd7Iml0ZW1faWQiOicuJGl0ZW1faWQuJ30nOw0KDQogICAgICAgICRyZWRlZW0gPSAkY3VybC0+cmVxdWVzdCAoJG1ldGhvZCwgJGVuZHBvaW50LCAkcGFyYW0sICRoZWFkZXIpOw0KICAgDQogICAgICAgICRqc29uID0ganNvbl9kZWNvZGUoJHJlZGVlbSk7DQoNCiAgICAgICAgaWYoJGpzb24tPnN0YXR1cyA9PSAxKSB7DQogICAgICAgICAgICByZXR1cm4gVFJVRTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJldHVybiBGQUxTRTsNCiAgICAgICAgfQ0KICAgIH0NCiANCn0NCg0KLyoqDQogKiBSdW5uaW5nDQogKi8NCg0KJG1vdG9ya3UgPSBuZXcgbW90b3JrdSgpOw0KDQplY2hvICJieSBAZWNvLm54bm5EaXNjbGFpbWVyOiBTZWdhbGEgYmVudHVrIHJlc2lrbyBhdGFzIHRpbmRha2FuIGluaSBzYXlhIHByaWJhZGkgdGlkYWsgYmVydGFuZ2d1bmcgamF3YWIsIGd1bmFrYW5sYWggc2Vub3JtYWwtbnlhIW5uIjsNCmVjaG8gIktvZGUgUmVmZXJyYWwgOiI7DQokcmVmZiA9IHRyaW0oZmdldHMoU1RESU4pKTsNCmNvaW46DQplY2hvICJKdW1sYWggS29pbiAgIDoiOw0KJGNvaW4gPSB0cmltKGZnZXRzKFNURElOKSk7DQppZighaXNfbnVtZXJpYygkY29pbikpIHsNCiAgICBnb3RvIGNvaW47DQp9IGVsc2VpZiAoJGNvaW4gPCAxNSl7DQogICAgZWNobyAiW2ldIE1hc3Vra2FuIGp1bWxhaCBrb2luIHlhbmcgZGlpbmdpbmthbm4iOw0KICAgIGdvdG8gY29pbjsNCn0NCmVjaG8gIm5uIjsNCg0KZWNobyAiQXV0byBSZWRlZW0gW1kvTl0gOiI7DQokYXV0b19yZWRlZW0gPSB0cmltKGZnZXRzKFNURElOKSk7DQppZiAoc3RydG9sb3dlcigkYXV0b19yZWRlZW0pPT0neScpIHsNCg0KICAgIGNoZWNrX3Rva2VuOg0KICAgICRmaWxlICA9ICJzcmMvdG9rZW4udHh0IjsNCiAgICAkbGlzdCAgPSBleHBsb2RlKCJuIixzdHJfcmVwbGFjZSgiciIsIiIsZmlsZV9nZXRfY29udGVudHMoJGZpbGUpKSk7DQoNCiAgICBpZighZW1wdHkoJGxpc3RbMF0pKSB7IA0KICAgICAgICAkX3Rva2VuID0gJGxpc3RbMF07DQoNCiAgICAgICAgJHN0YXR1c19sb2dpbiA9ICRtb3Rvcmt1LT5wcm9maWxlKCRfdG9rZW4pOw0KICAgICAgICBpZigkc3RhdHVzX2xvZ2luID09IGZhbHNlKSB7DQogICAgICAgICAgICBlY2hvICJbIV0gSW52YWxpZCBUb2tlbiEsIFNlc2kgdGVsYWggaGFiaXMubiI7DQogICAgICAgICAgICAkbG9naW5Qcm9ncmVzcyA9ICRtb3Rvcmt1LT5sb2dpblByb2dyZXNzKCk7DQogICAgICAgICAgICBpZigkbG9naW5Qcm9ncmVzcyA9PSBGQUxTRSkgew0KICAgICAgICAgICAgICAgICR2YWxpZFRva2VuID0gRkFMU0U7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICR2YWxpZFRva2VuID0gVFJVRTsNCiAgICAgICAgICAgICAgICAkb3duZXJfdG9rZW4gPSAkbG9naW5Qcm9ncmVzczsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICR2YWxpZFRva2VuID0gVFJVRTsNCiAgICAgICAgICAgICRvd25lcl90b2tlbiA9ICRfdG9rZW47DQogICAgICAgIH0gDQogICAgfSBlbHNlIHsNCiAgICAgICAgJGxvZ2luUHJvZ3Jlc3MgPSAkbW90b3JrdS0+bG9naW5Qcm9ncmVzcygpOw0KICAgICAgICBpZigkbG9naW5Qcm9ncmVzcyA9PSBGQUxTRSkgew0KICAgICAgICAgICAgJHZhbGlkVG9rZW4gPSBGQUxTRTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICR2YWxpZFRva2VuID0gVFJVRTsNCiAgICAgICAgICAgICRvd25lcl90b2tlbiA9ICRsb2dpblByb2dyZXNzOw0KICAgICAgICB9DQogICAgfQ0KDQp9DQoNCmlmKCR2YWxpZFRva2VuID09IFRSVUUpIHsNCiAgICAvKioNCiAgICAgKiBQcm9maWxlDQogICAgICovDQogICAgJGdldF9pbmZvID0gJG1vdG9ya3UtPnByb2ZpbGUoJG93bmVyX3Rva2VuKTsNCiAgICAkb3duZXJfbmFtYSAgPSAkZ2V0X2luZm8tPmRhdGEtPm5hbWU7DQogICAgJG93bmVyX3Bob25lID0gJGdldF9pbmZvLT5kYXRhLT5waG9uZV9udW1iZXI7DQogICAgJG93bmVyX3BvaW50ID0gJGdldF9pbmZvLT5kYXRhLT5wb2ludDsNCg0KICAgIGVjaG8gIltpXSBBbmRhIHNlZGFuZyBsb2dpbiBzZWJhZ2FpICIuJG93bmVyX25hbWEuIiBbIi4kb3duZXJfcGhvbmUuIl0sIFRvdGFsIFBvaW46ICIuJG93bmVyX3BvaW50LiJubiI7DQoNCiAgICBlY2hvICJQaWxpaCBOb21vciBLYXRlZ29yaSBWb3VjaGVyIFlhbmcgSW5naW4gRGkgUmVkZWVtIW4iOw0KICAgIGVjaG8gIjEuIE1ha2FuYW5uIjsNCiAgICBlY2hvICIyLiBCZWxhbmphbiI7DQogICAgcGlsaWg6DQogICAgZWNobyAiUGlsaWggOiI7DQogICAgJGNhdGVnb3JpID0gdHJpbShmZ2V0cyhTVERJTikpOw0KICAgIGlmICghaXNfbnVtZXJpYygkY2F0ZWdvcmkpKSB7DQogICAgICAgIGdvdG8gcGlsaWg7DQogICAgfSBlbHNlaWYoJGNhdGVnb3JpID4gMikgew0KICAgICAgICBnb3RvIHBpbGloOw0KICAgIH0NCg0KICAgIHN3aXRjaCgkY2F0ZWdvcmkpIHsNCiAgICAgICAgY2FzZSAiMSI6DQogICAgICAgICAgICB2b3VjaGVyMToNCiAgICAgICAgICAgICR2b3VjaGVyID0gJG1vdG9ya3UtPnZvdWNoZXIoMiwgJHRva2VuKTsNCiAgICAgICAgICAgIGlmKCR2b3VjaGVyPT1mYWxzZSkgew0KICAgICAgICAgICAgICAgIGdvdG8gdm91Y2hlcjE7DQogICAgICAgICAgICB9DQogICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICIyIjoNCiAgICAgICAgICAgIHZvdWNoZXIyOg0KICAgICAgICAgICAgJHZvdWNoZXIgPSAkbW90b3JrdS0+dm91Y2hlcig0LCAkdG9rZW4pOw0KICAgICAgICAgICAgaWYoJHZvdWNoZXI9PWZhbHNlKSB7DQogICAgICAgICAgICAgICAgZ290byB2b3VjaGVyMjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgYnJlYWs7DQogICAgfQ0KDQogICAgaWYoJG93bmVyX3BvaW50ID49IDUwMDApIHsNCiAgICAgICAgZWNobyAiW2ldIFBPSU5UIExPIFNVREFIIEJBTllBSywgSkFOR0FOIE1BUlVLISBMQU5KVVQgTEFOR1NVTkcgUkVERUVNIEFKQS5uIjsNCg0KICAgICAgICBmb3JlYWNoICgkdm91Y2hlciBhcyAkZGF0YVZvdWNoZXIpIHsNCiAgICAgICAgICAgICRpdGVtX2lkICAgID0gJGRhdGFWb3VjaGVyLT5pZDsNCiAgICAgICAgICAgICRpdGVtX25hbWUgID0gJGRhdGFWb3VjaGVyLT5uYW1lOw0KICAgICAgICAgICAgJGl0ZW1fcG9pbnQgPSAkZGF0YVZvdWNoZXItPnBvaW50Ow0KDQogICAgICAgICAgICAkcmVkZWVtID0gJG1vdG9ya3UtPnJlZGVlbSgkdG9rZW4sICRpdGVtX2lkKTsNCiAgICAgICAgICAgIGlmKCRyZWRlZW09PXRydWUpIHsNCiAgICAgICAgICAgICAgICBlY2hvICJbaV0gIi5kYXRlKCdIOmk6cycpLiIgfCAiLiRpdGVtX25hbWUuIiBiZXJoYXNpbCBkaSBSZWRlZW1uIjsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgZWNobyAiWyFdICIuZGF0ZSgnSDppOnMnKS4iIHwgR0FHQUwgUmVkZWVtICIuJGl0ZW1fbmFtZS4ibiI7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQp9DQoNCg0KJG5vPTE7DQokbG9vcCA9ICRjb2luLzE1Ow0Kd2hpbGUoVFJVRSkgew0KDQogICAgJHJhbmRvbXVzZXIgPSAkbW90b3JrdS0+cmFuZG9tdXNlcigpOw0KICAgIGZvcmVhY2ggKCRyYW5kb211c2VyIGFzICR2YWx1ZSkgew0KICAgICAgICAkZmlyc3RuYW1lID0gJHZhbHVlLT5GaXJzdG5hbWU7DQogICAgICAgICRsYXN0bmFtZSAgPSAkdmFsdWUtPkxhc3RuYW1lOw0KICAgICAgICAkZW1haWwgICAgID0gJHZhbHVlLT5FbWFpbDsNCg0KDQogICAgICAgIGZvciAoJGk9MDsgJGkgPCAyOyAkaSsrKSB7IA0KICAgICAgICAgICAgaWYoJGk9PTApIHsNCiAgICAgICAgICAgICAgICAkbmFtZSA9ICRmaXJzdG5hbWU7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRuYW1lID0gJGxhc3RuYW1lOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkcnVuID0gJG1vdG9ya3UtPnJlZ2lzKCRuYW1lLCAkZW1haWwsICRyZWZmKTsNCiAgICAgICAgICAgIGlmKCRydW49PXRydWUpIHsNCiAgICAgICAgICAgICAgICBlY2hvICJbIi4kbm8rKy4iXSAiLmRhdGUoJ0g6aTpzJykuIiB8IFJlZ2lzdHJhc2kgQmVyaGFzaWwuIjsNCg0KICAgICAgICAgICAgICAgIGlmKCR2YWxpZFRva2VuID09IFRSVUUpIHsNCiAgICAgICAgICAgICAgICAgICAgJHByb2ZpbGUgPSAkbW90b3JrdS0+cHJvZmlsZSgkb3duZXJfdG9rZW4pOyAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICR0b3RhbFBvaW4gPSAkcHJvZmlsZS0+ZGF0YS0+cG9pbnQ7ICAgICAgICAgICAgICAgICAgDQoNCiAgICAgICAgICAgICAgICAgICAgZWNobyAiVG90YWwgUG9pbiBTZWthcmFuZyAiLiR0b3RhbFBvaW4uIm4iOw0KDQogICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCAoJHZvdWNoZXIgYXMgJGRhdGFWb3VjaGVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkaXRlbV9pZCAgICA9ICRkYXRhVm91Y2hlci0+aWQ7DQogICAgICAgICAgICAgICAgICAgICAgICAkaXRlbV9uYW1lICA9ICRkYXRhVm91Y2hlci0+bmFtZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICRpdGVtX3BvaW50ID0gJGRhdGFWb3VjaGVyLT5wb2ludDsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgJGdldF9pbmZvX3BvaW50ID0gJG1vdG9ya3UtPnByb2ZpbGUoJG93bmVyX3Rva2VuKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICRvd25lcl9wb2ludCA9ICRnZXRfaW5mby0+ZGF0YS0+cG9pbnQ7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRvd25lcl9wb2ludCA+PSAkaXRlbV9wb2ludCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZWRlZW0gPSAkbW90b3JrdS0+cmVkZWVtKCR0b2tlbiwgJGl0ZW1faWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRyZWRlZW09PXRydWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNobyAiW2ldICIuZGF0ZSgnSDppOnMnKS4iIHwgIi4kaXRlbV9uYW1lLiIgYmVyaGFzaWwgZGkgUmVkZWVtbiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNobyAiWyFdICIuZGF0ZSgnSDppOnMnKS4iIHwgR0FHQUwgUmVkZWVtICIuJGl0ZW1fbmFtZS4ibiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICB9ICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYoJG5vID4gJGxvb3ApIHsNCiAgICAgICAgICAgICAgICAgICAgZWNobyAibm5ET05FIW5uIjsNCiAgICAgICAgICAgICAgICAgICAgZGllKCk7DQogICAgICAgICAgICAgICAgfSAgICAgICAgICAgICANCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgZWNobyAiWyFdICIuZGF0ZSgnSDppOnMnKS4iIHwgUmVnaXN0cmFzaSBHQUdBTG4iOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgc2xlZXAoMSk7DQogICAgICAgIH0gICANCiAgICAgICAgDQogICAgICAgIGlmKCR2YWxpZFRva2VuID09IFRSVUUpIHsNCiAgICAgICAgICAgIGlmKCRvd25lcl9wb2ludCA+PSA1MDAwKSB7DQogICAgICAgICAgICAgICAgZWNobyAiW2ldIFBPSU5UIExPIFNVREFIIEJBTllBSywgSkFOR0FOIE1BUlVLISBMQU5KVVQgTEFOR1NVTkcgUkVERUVNIEFKQS5uIjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGVjaG8gIltpXSBQT0lOVCBMTyBTVURBSCBCQU5ZQUssIEpBTkdBTiBNQVJVSyFubiI7DQogICAgICAgICAgICBkaWUoKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgDQogICAgfSAgIA0KfQ0KDQo/Pg==")); ?>
